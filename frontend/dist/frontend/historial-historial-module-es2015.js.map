{"version":3,"sources":["./src/app/views/admin/historial/historial.component.ts","./src/app/views/admin/historial/historial.component.html","./src/app/views/admin/historial/components/cards/card-historial-list/card-historial-list.component.ts","./src/app/views/admin/historial/historial-routing.module.ts","./src/app/core/services/modal.service.ts","./src/app/views/admin/historial/historial.module.ts","./src/app/views/admin/historial/components/cards/card-historial-list/card-historial-list.component.html","./src/app/core/services/historial.service.ts"],"names":[],"mappings":"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","file":"historial-historial-module-es2015.js","sourcesContent":["import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-historial',\n  templateUrl: './historial.component.html',\n  styles: [\n  ]\n})\nexport class HistorialComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit(): void {\n  }\n\n}\n","export default \"<app-card-historial-list></app-card-historial-list>\\n\";","import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { Subscription } from 'rxjs';\nimport { HistorialService } from 'src/app/core/services/historial.service';\nimport { Historial, HistorialResponse } from 'src/app/interfaces/historial';\nimport { Router } from '@angular/router';\nimport { ModalService } from 'src/app/core/services/modal.service';\n@Component({\n  selector: 'app-card-historial-list',\n  templateUrl: './card-historial-list.component.html',\n  styleUrls: []\n})\nexport class CardHistorialListComponent implements OnInit, OnDestroy {\n  sub: Subscription;\n  response: HistorialResponse;\n  constructor(\n    private historialService: HistorialService,\n    private modalService: ModalService,\n    private router: Router,\n  ) { }\n\n  ngOnInit(): void {\n    this.sub = new Subscription();\n    this.getHistorials();\n    this.subcriptionHistorials();\n  }\n\n  ngOnDestroy(): void {\n    this.sub.unsubscribe();\n  }\n\n  getHistorials() {\n    this.sub.add(\n      this.historialService.getHistorial({ force: true }).subscribe(\n        response => {\n          this.response = response;\n        }\n      )\n    );\n  }\n\n  subcriptionHistorials() {\n    this.sub.add(\n      this.historialService.response.subscribe(\n        response => {\n          if (response) {\n            this.response = response;\n          }\n        }\n      )\n    )\n  }\n\n  getOnPageResponse(page: number) {\n    this.response = null;\n    this.historialService\n      .getHistorial({\n        page,\n        force: true,\n      })\n      .subscribe((response) => {\n        this.historialService.response.emit(response);\n      });\n  }\n\n  goToAnotherPage(historial: Historial) {\n    this.router.navigate(['/admin/ingresos-salidas', historial.id]);\n    this.historialService.historial.emit(historial);\n  }\n\n  openCerrarHistorialModal(historial: Historial) {\n    this.modalService.modal.modalName = 'cierreHistorialModal';\n    this.modalService.modal.visible = true;\n    this.historialService.historial.emit(historial);\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { HistorialComponent } from './historial.component';\n\nconst routes: Routes = [{\n  path: '',\n  component: HistorialComponent\n}];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class HistorialRoutingModule { }\n","import { Injectable } from '@angular/core';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\n\r\n//Servicio global para activar un modal mediante su nombre y estado.\r\nexport class ModalService {\r\n\r\n  private _modal={\r\n    visible:false,\r\n    modalName:'',\r\n  };\r\n\r\n  public get modal(){\r\n    return this._modal;\r\n  }\r\n\r\n  public set modal(m){\r\n    this._modal = m;\r\n  }\r\n\r\n  public closeModal(){\r\n    this._modal.visible=false;\r\n    this._modal.modalName='';\r\n  }\r\n\r\n  constructor( ) { }\r\n}\r\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { HistorialRoutingModule } from './historial-routing.module';\nimport { HistorialComponent } from './historial.component';\nimport { CardHistorialListComponent } from './components/cards/card-historial-list/card-historial-list.component';\nimport { SharedModule } from '../../shared/shared.module';\n\n\n@NgModule({\n  declarations: [HistorialComponent, CardHistorialListComponent],\n  imports: [\n    SharedModule,\n    HistorialRoutingModule\n  ]\n})\nexport class HistorialModule { }\n","export default \"<div class=\\\"relative flex flex-col min-w-0 break-words bg-white w-full mb-6  rounded\\\">\\n  <div class=\\\"p-4 w-full \\\">\\n\\n    <div class=\\\"items-center mb-4 ml-2 mt-4 flex justify-between\\\">\\n      <h3 class=\\\"text-xl font-bold leading-none text-gray-500 dark:text-white\\\">\\n        Historial\\n      </h3>\\n    </div>\\n    <div class=\\\"flex flex-col\\\">\\n      <div class=\\\"overflow-x-auto sm:-mx-6 lg:-mx-8\\\">\\n          <div class=\\\"inline-block py-2 min-w-full sm:px-6 lg:px-8\\\">\\n              <div class=\\\"overflow-hidden sm:rounded-lg\\\">\\n                  <table class=\\\"min-w-full\\\">\\n                      <thead class=\\\"bg-gray-50 dark:bg-gray-700\\\">\\n                          <tr>\\n                              <th scope=\\\"col\\\" class=\\\"py-3 px-6 text-xs font-medium tracking-wider text-left text-gray-700 uppercase dark:text-gray-400\\\">\\n                                Fecha\\n                              </th>\\n                              <th scope=\\\"col\\\" class=\\\"py-3 px-6 text-xs font-medium tracking-wider text-left text-gray-700 uppercase dark:text-gray-400\\\">\\n                                Usuario\\n                              </th>\\n                              <th scope=\\\"col\\\" class=\\\"py-3 px-6 text-xs font-medium tracking-wider text-left text-gray-700 uppercase dark:text-gray-400\\\">\\n                                Operaci√≥n\\n                              </th>\\n                              <th scope=\\\"col\\\" class=\\\"py-3 px-6 text-xs font-medium tracking-wider text-left text-gray-700 uppercase dark:text-gray-400\\\">\\n                                Tabla\\n                              </th>\\n\\n                          </tr>\\n                      </thead>\\n                      <tbody *ngIf=\\\"response\\\" >\\n                          <tr\\n                            *ngFor=\\\"let historial of response.items\\\"\\n                            class=\\\"bg-white border-b cursor-pointer m-2 transform hover:-translate-y-1 ease-linear transition-all duration-150\\\"\\n                            [popper]=\\\"hi\\\"\\n                            [popperTrigger]=\\\"'click'\\\"\\n                            [popperPlacement]=\\\"'top'\\\"\\n                            [popperPositionFixed]=\\\"true\\\">\\n                            <td class=\\\"py-4 px-6 text-sm font-medium text-gray-900 whitespace-nowrap dark:text-white\\\">\\n                                {{ historial.createdAt | date:'medium' }}\\n                            </td>\\n                            <td class=\\\"py-4 px-6 text-sm text-gray-500 whitespace-nowrap dark:text-gray-400\\\">\\n                              {{ historial.user.ci }}\\n                            </td>\\n                            <td class=\\\"py-4 px-6 text-sm text-gray-500 whitespace-nowrap dark:text-gray-400\\\">\\n                                {{ historial.action }}\\n                            </td>\\n                            <td class=\\\"py-4 px-6 text-sm text-gray-500 whitespace-nowrap dark:text-gray-400\\\">\\n                                {{ historial.auditTable }}\\n                            </td>\\n                            <popper-content #hi>\\n                              <p class=\\\"bold\\\">{{ historial.previousData | json }}</p>\\n                              <p class=\\\"bold\\\">{{ historial.actualData | json }}</p>\\n                            </popper-content>\\n                          </tr>\\n\\n                      </tbody>\\n                  </table>\\n              </div>\\n          </div>\\n      </div>\\n  </div>\\n</div>\\n\\n<app-pagination\\n  *ngIf=\\\"response\\\"\\n  [response]=\\\"response.meta\\\"\\n  (pageEvent)=\\\"getOnPageResponse($event)\\\"\\n></app-pagination>\\n\";","import { Injectable, Output ,EventEmitter} from '@angular/core';\r\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\r\n\r\nimport { Observable } from 'rxjs';\r\n\r\nimport { environment } from '../../../environments/environment';\r\nimport { Historial, HistorialResponse } from 'src/app/interfaces/historial';\r\nimport { shareReplay } from 'rxjs/operators';\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class HistorialService {\r\n\r\n  @Output() historial:EventEmitter<Historial> = new EventEmitter();\r\n  @Output() response:EventEmitter<HistorialResponse> = new EventEmitter();\r\n  cacheResponse$: Observable<any>;\r\n  private baseUrl: string = environment.baseUrl;\r\n\r\n  constructor( private http: HttpClient ) { }\r\n\r\n  getHistorial({\r\n    page = 1,\r\n    force = false,\r\n  }):Observable<any>{\r\n    const headers = new HttpHeaders()\r\n      .set('x-access-token',sessionStorage.getItem('token')||'');\r\n    if (force || !this.cacheResponse$) {\r\n      return this.cacheResponse$ = this.http\r\n        .get(`${this.baseUrl}/audit?page=${page}`,{headers})\r\n        .pipe( shareReplay(1));\r\n    }\r\n    return this.cacheResponse$;\r\n  }\r\n}\r\n"],"sourceRoot":"webpack:///"}