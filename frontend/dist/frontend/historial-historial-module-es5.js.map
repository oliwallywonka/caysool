{"version":3,"sources":["webpack:///src/app/views/admin/historial/historial.component.ts","webpack:///src/app/views/admin/historial/historial.component.html","webpack:///src/app/views/admin/historial/components/cards/card-historial-list/card-historial-list.component.ts","webpack:///src/app/views/admin/historial/historial-routing.module.ts","webpack:///src/app/core/services/modal.service.ts","webpack:///src/app/views/admin/historial/historial.module.ts","webpack:///src/app/views/admin/historial/components/cards/card-historial-list/card-historial-list.component.html","webpack:///src/app/core/services/historial.service.ts"],"names":["HistorialComponent","selector","template","CardHistorialListComponent","historialService","modalService","router","sub","getHistorials","subcriptionHistorials","unsubscribe","add","getHistorial","force","subscribe","response","page","emit","historial","navigate","id","modal","modalName","visible","routes","path","component","HistorialRoutingModule","imports","forChild","exports","ModalService","_modal","m","providedIn","HistorialModule","declarations","HistorialService","http","baseUrl","headers","set","sessionStorage","getItem","cacheResponse$","get","pipe"],"mappings":"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","file":"historial-historial-module-es5.js","sourcesContent":["import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-historial',\n  templateUrl: './historial.component.html',\n  styles: [\n  ]\n})\nexport class HistorialComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit(): void {\n  }\n\n}\n","export default \"<app-card-historial-list></app-card-historial-list>\\n\";","import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { Subscription } from 'rxjs';\nimport { HistorialService } from 'src/app/core/services/historial.service';\nimport { Historial, HistorialResponse } from 'src/app/interfaces/historial';\nimport { Router } from '@angular/router';\nimport { ModalService } from 'src/app/core/services/modal.service';\n@Component({\n  selector: 'app-card-historial-list',\n  templateUrl: './card-historial-list.component.html',\n  styleUrls: []\n})\nexport class CardHistorialListComponent implements OnInit, OnDestroy {\n  sub: Subscription;\n  response: HistorialResponse;\n  constructor(\n    private historialService: HistorialService,\n    private modalService: ModalService,\n    private router: Router,\n  ) { }\n\n  ngOnInit(): void {\n    this.sub = new Subscription();\n    this.getHistorials();\n    this.subcriptionHistorials();\n  }\n\n  ngOnDestroy(): void {\n    this.sub.unsubscribe();\n  }\n\n  getHistorials() {\n    this.sub.add(\n      this.historialService.getHistorial({ force: true }).subscribe(\n        response => {\n          this.response = response;\n        }\n      )\n    );\n  }\n\n  subcriptionHistorials() {\n    this.sub.add(\n      this.historialService.response.subscribe(\n        response => {\n          if (response) {\n            this.response = response;\n          }\n        }\n      )\n    )\n  }\n\n  getOnPageResponse(page: number) {\n    this.response = null;\n    this.historialService\n      .getHistorial({\n        page,\n        force: true,\n      })\n      .subscribe((response) => {\n        this.historialService.response.emit(response);\n      });\n  }\n\n  goToAnotherPage(historial: Historial) {\n    this.router.navigate(['/admin/ingresos-salidas', historial.id]);\n    this.historialService.historial.emit(historial);\n  }\n\n  openCerrarHistorialModal(historial: Historial) {\n    this.modalService.modal.modalName = 'cierreHistorialModal';\n    this.modalService.modal.visible = true;\n    this.historialService.historial.emit(historial);\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { HistorialComponent } from './historial.component';\n\nconst routes: Routes = [{\n  path: '',\n  component: HistorialComponent\n}];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class HistorialRoutingModule { }\n","import { Injectable } from '@angular/core';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\n\r\n//Servicio global para activar un modal mediante su nombre y estado.\r\nexport class ModalService {\r\n\r\n  private _modal={\r\n    visible:false,\r\n    modalName:'',\r\n  };\r\n\r\n  public get modal(){\r\n    return this._modal;\r\n  }\r\n\r\n  public set modal(m){\r\n    this._modal = m;\r\n  }\r\n\r\n  public closeModal(){\r\n    this._modal.visible=false;\r\n    this._modal.modalName='';\r\n  }\r\n\r\n  constructor( ) { }\r\n}\r\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { HistorialRoutingModule } from './historial-routing.module';\nimport { HistorialComponent } from './historial.component';\nimport { CardHistorialListComponent } from './components/cards/card-historial-list/card-historial-list.component';\nimport { SharedModule } from '../../shared/shared.module';\n\n\n@NgModule({\n  declarations: [HistorialComponent, CardHistorialListComponent],\n  imports: [\n    SharedModule,\n    HistorialRoutingModule\n  ]\n})\nexport class HistorialModule { }\n","export default \"<div class=\\\"relative flex flex-col min-w-0 break-words bg-white w-full mb-6  rounded\\\">\\n  <div class=\\\"p-4 w-full \\\">\\n\\n    <div class=\\\"items-center mb-4 ml-2 mt-4 flex justify-between\\\">\\n      <h3 class=\\\"text-xl font-bold leading-none text-gray-500 dark:text-white\\\">\\n        Historial\\n      </h3>\\n    </div>\\n    <div class=\\\"flex flex-col\\\">\\n      <div class=\\\"overflow-x-auto sm:-mx-6 lg:-mx-8\\\">\\n          <div class=\\\"inline-block py-2 min-w-full sm:px-6 lg:px-8\\\">\\n              <div class=\\\"overflow-hidden sm:rounded-lg\\\">\\n                  <table class=\\\"min-w-full\\\">\\n                      <thead class=\\\"bg-gray-50 dark:bg-gray-700\\\">\\n                          <tr>\\n                              <th scope=\\\"col\\\" class=\\\"py-3 px-6 text-xs font-medium tracking-wider text-left text-gray-700 uppercase dark:text-gray-400\\\">\\n                                Fecha\\n                              </th>\\n                              <th scope=\\\"col\\\" class=\\\"py-3 px-6 text-xs font-medium tracking-wider text-left text-gray-700 uppercase dark:text-gray-400\\\">\\n                                Usuario\\n                              </th>\\n                              <th scope=\\\"col\\\" class=\\\"py-3 px-6 text-xs font-medium tracking-wider text-left text-gray-700 uppercase dark:text-gray-400\\\">\\n                                Operación\\n                              </th>\\n                              <th scope=\\\"col\\\" class=\\\"py-3 px-6 text-xs font-medium tracking-wider text-left text-gray-700 uppercase dark:text-gray-400\\\">\\n                                Tabla\\n                              </th>\\n\\n                          </tr>\\n                      </thead>\\n                      <tbody *ngIf=\\\"response\\\" >\\n                          <tr\\n                            *ngFor=\\\"let historial of response.items\\\"\\n                            class=\\\"bg-white border-b cursor-pointer m-2 transform hover:-translate-y-1 ease-linear transition-all duration-150\\\"\\n                            [popper]=\\\"hi\\\"\\n                            [popperTrigger]=\\\"'click'\\\"\\n                            [popperPlacement]=\\\"'top'\\\"\\n                            [popperPositionFixed]=\\\"true\\\">\\n                            <td class=\\\"py-4 px-6 text-sm font-medium text-gray-900 whitespace-nowrap dark:text-white\\\">\\n                                {{ historial.createdAt | date:'medium' }}\\n                            </td>\\n                            <td class=\\\"py-4 px-6 text-sm text-gray-500 whitespace-nowrap dark:text-gray-400\\\">\\n                              {{ historial.user.ci }}\\n                            </td>\\n                            <td class=\\\"py-4 px-6 text-sm text-gray-500 whitespace-nowrap dark:text-gray-400\\\">\\n                                {{ historial.action }}\\n                            </td>\\n                            <td class=\\\"py-4 px-6 text-sm text-gray-500 whitespace-nowrap dark:text-gray-400\\\">\\n                                {{ historial.auditTable }}\\n                            </td>\\n                            <popper-content #hi>\\n                              <p class=\\\"bold\\\">{{ historial.previousData | json }}</p>\\n                              <p class=\\\"bold\\\">{{ historial.actualData | json }}</p>\\n                            </popper-content>\\n                          </tr>\\n\\n                      </tbody>\\n                  </table>\\n              </div>\\n          </div>\\n      </div>\\n  </div>\\n</div>\\n\\n<app-pagination\\n  *ngIf=\\\"response\\\"\\n  [response]=\\\"response.meta\\\"\\n  (pageEvent)=\\\"getOnPageResponse($event)\\\"\\n></app-pagination>\\n\";","import { Injectable, Output ,EventEmitter} from '@angular/core';\r\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\r\n\r\nimport { Observable } from 'rxjs';\r\n\r\nimport { environment } from '../../../environments/environment';\r\nimport { Historial, HistorialResponse } from 'src/app/interfaces/historial';\r\nimport { shareReplay } from 'rxjs/operators';\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class HistorialService {\r\n\r\n  @Output() historial:EventEmitter<Historial> = new EventEmitter();\r\n  @Output() response:EventEmitter<HistorialResponse> = new EventEmitter();\r\n  cacheResponse$: Observable<any>;\r\n  private baseUrl: string = environment.baseUrl;\r\n\r\n  constructor( private http: HttpClient ) { }\r\n\r\n  getHistorial({\r\n    page = 1,\r\n    force = false,\r\n  }):Observable<any>{\r\n    const headers = new HttpHeaders()\r\n      .set('x-access-token',sessionStorage.getItem('token')||'');\r\n    if (force || !this.cacheResponse$) {\r\n      return this.cacheResponse$ = this.http\r\n        .get(`${this.baseUrl}/audit?page=${page}`,{headers})\r\n        .pipe( shareReplay(1));\r\n    }\r\n    return this.cacheResponse$;\r\n  }\r\n}\r\n"]}